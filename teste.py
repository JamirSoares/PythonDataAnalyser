import ast
from datetime import datetime, timedelta

eventos = "[{'hora': '9', 'beginning': '2025-07-01-09:13:00', 'ending': '2025-07-01-09:31:00', 'description': '4533 - Indisponibilidade parcial de conex�o | WAN2 - LJ72', 'url_id': 4533, 'horas_Apontadas': 18.0}, {'hora': '9', 'beginning': '2025-07-01-09:21:00', 'ending': '2025-07-01-09:28:00', 'description': '4526 - Host Indispon�vel por ICMP Ping - NetService Vit�ria', 'url_id': 4526, 'horas_Apontadas': 7.0}, {'hora': '10', 'beginning': '2025-07-01-10:07:00', 'ending': '2025-07-01-10:10:00', 'description': '4533 - Indisponibilidade parcial de conex�o | WAN2 - LJ72', 'url_id': 4533, 'horas_Apontadas': 3.0}, {'hora': '10', 'beginning': '2025-07-01-10:55:00', 'ending': '2025-07-01-10:55:00', 'description': '4526 - Host Indispon�vel por ICMP Ping - NetService Vit�ria', 'url_id': 4526, 'horas_Apontadas': 0.0}, {'hora': '13', 'beginning': '2025-07-01-13:16:00', 'ending': '2025-07-01-13:29:00', 'description': '4540 - Envio de e-mail', 'url_id': 4540, 'horas_Apontadas': 13.0}, {'hora': '8', 'beginning': '2025-07-03-08:30:00', 'ending': '2025-07-03-08:33:00', 'description': '4557 - Troca de trafeco de link Loja 56', 'url_id': 4557, 'horas_Apontadas': 3.0}, {'hora': '10', 'beginning': '2025-07-03-10:19:00', 'ending': '2025-07-03-10:45:00', 'description': '4551 - LOJAS REDE - 56 | WAN1 - Algar | Alta perda de pacote', 'url_id': 4551, 'horas_Apontadas': 26.0}, {'hora': '10', 'beginning': '2025-07-03-10:27:00', 'ending': '2025-07-03-10:27:00', 'description': '4559 - Comap ILNT - Datacenter - Serra', 'url_id': 4559, 'horas_Apontadas': 0.0}, {'hora': '10', 'beginning': '2025-07-03-10:35:00', 'ending': '2025-07-03-10:43:00', 'description': '4559 - Comap ILNT - Datacenter - Serra', 'url_id': 4559, 'horas_Apontadas': 8.0}, {'hora': '12', 'beginning': '2025-07-03-12:42:00', 'ending': '2025-07-03-12:42:00', 'description': '4560 - Configurar Impressora ', 'url_id': 4560, 'horas_Apontadas': 0.0}, {'hora': '13', 'beginning': '2025-07-03-13:51:00', 'ending': '2025-07-03-13:51:00', 'description': '4561 - \tWatchDog2 - Datacenter - Serra', 'url_id': 4561, 'horas_Apontadas': 0.0}, {'hora': '10', 'beginning': '2025-07-05-10:09:00', 'ending': '2025-07-05-10:13:00', 'description': '4576 - Indisponibilidade parcial de conex�o', 'url_id': 4576, 'horas_Apontadas': 4.0}, {'hora': '13', 'beginning': '2025-07-05-13:40:00', 'ending': '2025-07-05-13:51:00', 'description': '4577 - Alta perda de pacotes | WAN2 LJ43', 'url_id': 4577, 'horas_Apontadas': 11.0}, {'hora': '15', 'beginning': '2025-07-05-15:11:00', 'ending': '2025-07-05-15:22:00', 'description': '4577 - Alta perda de pacotes | WAN2 LJ43', 'url_id': 4577, 'horas_Apontadas': 11.0}, {'hora': '15', 'beginning': '2025-07-05-15:38:00', 'ending': '2025-07-05-15:38:00', 'description': '4578 - Alta perda de pacotes', 'url_id': 4578, 'horas_Apontadas': 0.0}, {'hora': '16', 'beginning': '2025-07-05-16:42:00', 'ending': '2025-07-05-16:51:00', 'description': '4579 - Indisponibilidade parcial de conex�o | LJ38,39 WAN1', 'url_id': 4579, 'horas_Apontadas': 9.0}, {'hora': '16', 'beginning': '2025-07-05-16:52:00', 'ending': '2025-07-05-16:52:00', 'description': '4577 - Alta perda de pacotes | WAN2 LJ43', 'url_id': 4577, 'horas_Apontadas': 0.0}, {'hora': '16', 'beginning': '2025-07-05-16:53:00', 'ending': '2025-07-05-16:53:00', 'description': '4578 - Alta perda de pacotes', 'url_id': 4578, 'horas_Apontadas': 0.0}, {'hora': '17', 'beginning': '2025-07-05-17:15:00', 'ending': '2025-07-05-17:19:00', 'description': '4576 - Indisponibilidade parcial de conex�o', 'url_id': 4576, 'horas_Apontadas': 4.0}, {'hora': '17', 'beginning': '2025-07-05-17:42:00', 'ending': '2025-07-05-17:47:00', 'description': '4576 - Indisponibilidade parcial de conex�o', 'url_id': 4576, 'horas_Apontadas': 5.0}, {'hora': '18', 'beginning': '2025-07-05-18:15:00', 'ending': '2025-07-05-18:21:00', 'description': '4580 - Indisponibilidade parcial de conex�o | LJs 107,04,108,64', 'url_id': 4580, 'horas_Apontadas': 6.0}, {'hora': '18', 'beginning': '2025-07-05-18:25:00', 'ending': '2025-07-05-18:25:00', 'description': '4580 - Indisponibilidade parcial de conex�o | LJs 107,04,108,64', 'url_id': 4580, 'horas_Apontadas': 0.0}, {'hora': '18', 'beginning': '2025-07-05-18:28:00', 'ending': '2025-07-05-18:43:00', 'description': '4581 - Alta perda de pacotes | LJs 30,43', 'url_id': 4581, 'horas_Apontadas': 15.0}, {'hora': '9', 'beginning': '2025-07-07-09:41:00', 'ending': '2025-07-07-09:42:00', 'description': '4590 - AUMENTO DE TEMPERATURA DO DATACENTE �CIMA DE 30�', 'url_id': 4590, 'horas_Apontadas': 1.0}, {'hora': '10', 'beginning': '2025-07-07-10:26:00', 'ending': '2025-07-07-10:32:00', 'description': '4551 - LOJAS REDE - 56 | WAN1 - Algar | Alta perda de pacote', 'url_id': 4551, 'horas_Apontadas': 6.0}, {'hora': '12', 'beginning': '2025-07-07-12:54:00', 'ending': '2025-07-07-13:01:00', 'description': '4593 - Indisponibilidade parcial de conex�o', 'url_id': 4593, 'horas_Apontadas': 7.0}, {'hora': '13', 'beginning': '2025-07-07-13:22:00', 'ending': '2025-07-07-13:36:00', 'description': '4593 - Indisponibilidade parcial de conex�o', 'url_id': 4593, 'horas_Apontadas': 14.0}, {'hora': '15', 'beginning': '2025-07-07-15:20:00', 'ending': '2025-07-07-15:25:00', 'description': '4595 - Comap IL-NT - DataCenter - Serra', 'url_id': 4595, 'horas_Apontadas': 5.0}, {'hora': '16', 'beginning': '2025-07-07-16:16:00', 'ending': '2025-07-07-16:20:00', 'description': '4597 - Indisponibilidade parcial de conex�o Link: WAN2 Loja: LJ96', 'url_id': 4597, 'horas_Apontadas': 4.0}, {'hora': '16', 'beginning': '2025-07-07-16:23:00', 'ending': '2025-07-07-16:25:00', 'description': '4598 - Indisponibilidade parcial de conex�o Link: WAN2 | Loja LJ65', 'url_id': 4598, 'horas_Apontadas': 2.0}, {'hora': '16', 'beginning': '2025-07-07-16:36:00', 'ending': '2025-07-07-16:36:00', 'description': '4597 - Indisponibilidade parcial de conex�o Link: WAN2 Loja: LJ96', 'url_id': 4597, 'horas_Apontadas': 0.0}, {'hora': '7', 'beginning': '2025-07-09-07:57:00', 'ending': '2025-07-09-07:57:00', 'description': '4610 - LJ31 | WAN1 e WAN2 | Indisponibilidade Total de Conex�o', 'url_id': 4610, 'horas_Apontadas': 0.0}, {'hora': '8', 'beginning': '2025-07-09-08:00:00', 'ending': '2025-07-09-08:04:00', 'description': '4612 - Equipamentos da B�rbara e Darlan', 'url_id': 4612, 'horas_Apontadas': 4.0}, {'hora': '9', 'beginning': '2025-07-09-09:00:00', 'ending': '2025-07-09-09:57:00', 'description': '4612 - Equipamentos da B�rbara e Darlan', 'url_id': 4612, 'horas_Apontadas': 57.0}, {'hora': '11', 'beginning': '2025-07-09-11:25:00', 'ending': '2025-07-09-11:30:00', 'description': '4619 - Indisponibilidade parcial de conex�o | Link: WAN1Loja:\xa0lj53', 'url_id': 4619, 'horas_Apontadas': 5.0}, {'hora': '12', 'beginning': '2025-07-09-12:30:00', 'ending': '2025-07-09-12:43:00', 'description': '4619 - Indisponibilidade parcial de conex�o | Link: WAN1Loja:\xa0lj53', 'url_id': 4619, 'horas_Apontadas': 13.0}, {'hora': '14', 'beginning': '2025-07-09-14:27:00', 'ending': '2025-07-09-14:40:00', 'description': '4621 - Indisponibilidade parcial de conex�o | Link: WAN1 Loja: LJ15  LJ 05', 'url_id': 4621, 'horas_Apontadas': 13.0}, {'hora': '14', 'beginning': '2025-07-09-14:49:00', 'ending': '2025-07-09-14:57:00', 'description': '4621 - Indisponibilidade parcial de conex�o | Link: WAN1 Loja: LJ15  LJ 05', 'url_id': 4621, 'horas_Apontadas': 8.0}, {'hora': '15', 'beginning': '2025-07-09-15:47:00', 'ending': '2025-07-09-15:54:00', 'description': '4622 - Indisponibilidade parcial de conex�o | Link: WAN1 Loja: LJ64', 'url_id': 4622, 'horas_Apontadas': 7.0}, {'hora': '17', 'beginning': '2025-07-09-17:05:00', 'ending': '2025-07-09-17:11:00', 'description': '4621 - Indisponibilidade parcial de conex�o | Link: WAN1 Loja: LJ15  LJ 05', 'url_id': 4621, 'horas_Apontadas': 6.0}]" # sua string completa aqui


def 
eventos_lista = ast.literal_eval(eventos)

# Extrair datas únicas (YYYY-MM-DD)
beginning_array = [datetime.fromisoformat(item['beginning']).strftime('%Y-%m-%d') for item in eventos_lista]

dias_unicos = sorted(set(beginning_array))

horas_por_dia = []

for dia in dias_unicos:
    soma_minutos = 0
    for i, data in enumerate(beginning_array):
        if data == dia:
            soma_minutos += eventos_lista[i]['horas_Apontadas']  # soma direto o valor numérico em minutos
    tempo_total = timedelta(minutes=soma_minutos)
    horas_formatadas = str(tempo_total)[:-3]  # Remove os últimos 3 caracteres para tirar os segundos
    horas_por_dia.append((dia, horas_formatadas))

# Exibir o resultado
for dia, horas in horas_por_dia:
    print(f"{dia} - {horas} horas")
